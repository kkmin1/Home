<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="eco-math.css">
    <link rel="stylesheet" type="text/css" href="footnote.css">
  
  <title>위상도(Phase Diagram)</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]} }); </script>
    <script src="./latex.js"></script>

    <script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
    <script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script>
    <script>
$(function () {
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
    						template:       sagecell.templates.minimal, 
            //               evalButtonText: 'Launch the Interactive Applet Now',
                            autoeval:true});
});
    </script>

 </head>

<body>
<h1>位相圖(Phase Diagram) 분석</h1>
<br>
<h2> 단일방정식인 경우 </h2>
<br>
<h3> 위상도</h3>

<p> 다음과 같은 미분방정식을 생각해 보자.</p> 

<p> $ \dfrac{dy(t)}{dt}=f(y) $ </p> 

<p> 위상도 분석은 미분방정식의 해를 구하기 어려울 때 기하학적으로 해의 의미를 해석하는데 유용하게 사용된다. 특히 경제학에서 그림의 형태를 보고 해의 수렴 또는 발산을 판정하는 데 사용된다. </p>

<p> 위상도는 수평축을 $ y(t) $, 수직축을 $ \dfrac{dy(t)}{dt} $로 놓고 $ y $와 $ \dfrac{dy}{dt} $의 관계를 표현한 것이다. </p>
<br>

<h3> 위상선(phase line)</h3>
<p>위상선은 위상도에 $y$와 $ \dfrac{dy}{dt} $의 관계를 나타내는 선이다.</p>

<p>값이 수평축 위에 있을 때, 즉 $ \dfrac{dy}{dt} > 0 $ 일 때 $ y $는 시간이 흐름에 따라 증가함을 의미. 그래프에서는 $ y $ 선상에 왼쪽에서 오른쪽으로 화살표를 표시한다.    </p>
<p>값이 수평축 아래에 있을 때, 즉 $\dfrac{dy}{dt} < 0 $ 일 때 $ y $는 시간이 흐름에 따라 감소함을 의미. 그래프에서는 $ y $ 선상에 오른쪽에서 왼쪽으로 화살표를 표시한다.   </p>
  <p>$ \dfrac{dy}{dt}= 0 $ 인 점을 임계점(critical point) 또는 균형점(equilibrium point)이라 한다.  </p>
  <p> 특히 경제학에서는 이 점을 정상상태 균형(steady-state equilibrium)이라 한다. <input type="checkbox" id="cb4" /><label for="cb4"><sup></sup>
  </label> <span><br><br>1.물리, 화학 등 다른 학문에서는 정상상태(steady-state)는 안정상태를 의미하는 것으로 쓰임. 경제학에서의 일정상태(steady-state)는 소득, 소비, 자본 등이 모두 일정한 속도로 성장하는 것을 의미한다. <br><br></span> </p>

<p> $ \dfrac{dy}{dt}= 0 $ 인 점에서 화살표가 모이면, 즉 $f(y^∗) < 0 $이면 해의 수렴을 의미하므로 안정상태 균형(stable equilibrium)이라 한다.</p>
  <p>$ \dfrac{dy}{dt}= 0 $ 인 점에서 화살표가 모이지 않는다면, 즉 $f(y^∗) > 0 $이면 해의 발산을 의미하므로 해는 불안정 상태에 있음을 알 수 있다. </p>
  <p>즉, 교차점에서 위상선의 기울기가 음(-)일 때 교차점은 안정적이고, 교차점에서 위상선의 기울기가 양(+)일 때 교차점은 불안정함을 알 수 있다.   </p>
  <br>
	

<h3> 위상도 예1 </h3>

<div style="text-align : center;">
  <figure>
    <p>$$  
      \begin{tikzpicture}[scale=2]
          % draw the axis
          \draw [thick, ->] (-1,0) -- (5,0); 
          \draw [thick, ->] (0,-1) -- (0,2); 
          % draw the curve
          \draw [blue, thick, domain=0.5:3.5] plot (\x, {-(\x-1)*(\x-3)});
          % draw the arrows
          \draw [->, very thick, red] (0.9,-0.21) -- (0.8,-0.44);
          \draw [->, very thick, red] (1.1,0.19) -- (1.2,0.36);
          \draw [->, very thick, red] (1.5,0.75) -- (1.6,0.84);
          \draw [->, very thick, red] (2.4,0.84) -- (2.5,0.75);
          \draw [->, very thick, red] (2.8,0.36) -- (2.9,0.19);
          \draw [->, very thick, red] (3.2,-0.44) -- (3.1,-0.21);
          % draw the labels
          \node at (-0.2,-0.2) {$0$};
          \node at (0,2.3){$\dfrac{dy(t)}{dt}$};
          \node at (5.2,0){$y(t)$};
          \filldraw [gray] (1,0) circle (2pt); 
          \filldraw [gray] (3,0) circle (2pt); 
          \node at (1.2,-0.5){$y_{1}(t)^*$};
          \node at (2.8,-0.5){$y_{2}(t)^*$};
      \end{tikzpicture}
      $$</p>
      <br>
  <figcaption>  (그림 1) 해의 수렴, 발산  </figcaption>
</figure>
</div>
<br>

<p>(그림 1)에서 보듯이 $y$의 증감을 화살표로 표시한다. 화살표의 방향은 위상선의 기울기와는 무관하다.</p>

<p> (그림 1)에는 $y_{1}(t)^*$, $y_{2}(t)^*$, 2개의 균형점이 존재한다. </p>
 
<p>(그림 1)에서 보듯이 교차점에서 위상선의 기울기가 음일 때 교차점은 안정적임을 알 수 있다. $y_{2}(t)^*$는 시간이 흘러도 변하지 않고 안정적이므로 안정상태 균형(stable equilibrium)임을 알 수 있다. $y_{1}(t)^*$는 시간이 흐름에 따라 안정적이지 않고 미세한 왼쪽의 움직임은 왼쪽, 미세한 오른쪽의 움직임은 오른쪽으로 이동한다. 교차점에서 위상선의 기울기가 양일 때 교차점은 안정적이지 않다. </p>
<br>

<h3> 위상도 예2 </h3>

<div style="text-align : center;">
  
  <figure>
    <p>$$  
      \begin{tikzpicture}[scale=2]
          % draw the axis
          \draw [thick, ->] (-1,0) -- (4,0); 
          \draw [thick, ->] (0,-1) -- (0,2.5); 
          % draw the curve
          \draw [blue, thick, domain=0.7:3.3] plot (\x, {(\x-2)*(\x-2)});
          % draw the arrows
          \draw [->, very thick, red] (0.9,1.21) -- (1,1);
          \draw [->, very thick, red] (1.5,0.25) -- (1.6,0.16);
          \draw [->, very thick, red] (2.5,0.25) -- (2.6,0.36);
          \draw [->, very thick, red] (3,1) -- (3.1,1.21);
          
          % draw the labels
          \node at (-0.2,-0.2) {$0$};
          \node at (0,2.8){$\dfrac{dy(t)}{dt}$};
          \node at (4.2,0){$y(t)$};
          \filldraw [gray] (2,0) circle (2pt); 
          \node at (2,-0.3){$y(t)^*$};
          
      \end{tikzpicture}
      $$</p>
      <br>
  <figcaption>  (그림 2) 해가 안장점인 경우  </figcaption>
</figure>
</div>
<br>

<p> $ y(t) < y^∗ $ 일 때 $ \dfrac{dy}{dt} > 0 $, $ y(t) > y^∗ $ 일 때 $ \dfrac{dy}{dt} > 0 $   
따라서 $ y^∗ $는 불안정함을 알 수 있다. 이와 같이 접하는 경우의 해를 안장점(saddle point)라고 한다. 안장점도 불안정한 균형이다. </p>
<br>

<h3 class="inline"> 솔로우 성장모형 </h3><input type="checkbox" id="cb1" /><label for="cb1"><sup></sup>
</label><span><br><br> '솔로우 성장모형(Solow growth model)'에 대한 자세한 생략하고 여기서는 결론부분만 간단히
  설명한다.<br><br></span></p>
<p> 솔로우 성장모형은 다음과 같다.

<p> 총생산함수 $ Y = F(K,L) $, $ K $는 자본, $ L $은 노동 </p> 
<p> (가정) 생산함수 $ Y $는 증가함수면서 강오목함수이다. $ s $는 저축률로 일정하며, 노동증가율은 $ \lambda $ 로 일정하다.</p>
<p> (풀이) $ y = \dfrac{\partial F}{\partial L}$, $k = \dfrac{K}{L} $ 이라 하면 솔로우 기본방정식은 $ \dfrac{dk}{dt} = sy(k)-\lambda k $이다.</p>
<p> 이는 비선형 미분방정식이므로 해를 도출하기가 쉽지않다. 해를 구하지 않고도 솔로우 모형의 해가 수렴 또는 발산하는지 알기위해
  이를 그림으로 표현하면 (그림 3)과 같다.</p>
<p>(그림 3)에서 알 수 있듯이 최적 자본량 $k^*$는 안정해(stable equilibrium)임을 알 수 있다.</p>

<div style="text-align : center;">
  <figure>
   <p>$$
    \usetikzlibrary{decorations.markings}
    \begin{tikzpicture}[scale=2]
		\draw [thick, ->] (-2,0.5) -- (5,0.5); 
		\draw [thick, ->] (-1,-1) -- (-1,4);
		\draw [blue, thick] (-1,0.5) -- (4,4); 
		\draw [dashed] (3.2,0.5) -- (3.2,4); 
		\draw [orange,thick] (-1,0.5) .. controls (1,3) and  (3,3.5) .. (4,3.6); 
		\filldraw [gray] (3.2,0.5) circle (2pt); 

    \begin{scope}[smooth,postaction={decorate},decoration={ markings, mark=at position 0.2 with {\arrow{>}}, mark=at position 0.4 with {\arrow{>}}, mark=at position 0.6 with {\arrow{>}}, mark=at position 0.8 with {\arrow{<}}, mark=at position 0.9 with {\arrow{<}} }]
    \draw[red, thick,postaction={decorate}] (-1,0.5) .. controls (1,1.5) and  (3,1.5) .. (4.5,-1);
    \end{scope}

		\node at (-1.3,0.2) {$0$};
		\node at (5.5,0.5){$k(t)$};
		\node at (3.2,0){$k(t)^*$};
		\node at (1.7,1.3){$sy(k)-\lambda k$};
		\node at (4.2,4.2){$\lambda k$};
		\node at (4.5,3.6){$sy(k)$};
	\end{tikzpicture} 
$$</p>
<br>
<figcaption>  (그림 3) 솔로우 성장모형  </figcaption>
</figure>
</div>
<br>

<h2> 연립미분방정식인 경우 (상태변수가 2 이상)</h2>
<br>
<p> 다음의 연립미분방정식을 고려한다. </p>
<p> $ \mathbf y'(t) = \mathbf A(t) \mathbf y(t) + \mathbf v(t)$ </p>
<p> 위상도 분석은 $ \mathbf A $가 2×2 행렬인 경우에 대해서만 가능하다. 그 이상인 경우는 그림으로
  분석하기 곤란하기 때문이다. </p>
<p> $ \mathbf y'(t) = 0 $인 곡선을 등고선(等高線, zero-growth isoclines)이라 한다. 
  등고선은 함수의 기울기가 항상 같은 점을 모은 선을 의미한다. 이 경우는 예를 들어 설명하는 것이 편리하다.</p>
  <br>

<h3> 예1 </h3>

<p> $x$, $y$는 시간 t의 함수, $x(t), y(t)$ </p>

<p> $ \dfrac{dx}{dt} = -2x $</p>
<p> $ \dfrac{dy}{dt} = 2x - 4y +32 $</p>
<br>

<p id="min1">[풀이]</p>

<p>균형점은 $ \dfrac{dx}{dt} = \dfrac{dy}{dt} = 0 $ 에서 결정되므로 </p>
<p> $ \dfrac{dx}{dt} = -2x = 0 \Longrightarrow x = 0 $........... ①  </p>
<p> $ \dfrac{dy}{dt} = 2x - 4y +32 = 0 \Longrightarrow y = \dfrac{1}{2}x + 8 $........... ②  </p>
<p> 이 두 연립방정식의 해는 ①, ②를 동시에 만족시켜야 한다.</p>
<p>따라서 균형점은 $(0, 8)$ 이 된다.</p>
<p>이제 이 해의 수렴, 발산 여부를 판정해 보자.</p>
<p> 이 연립미분방정식의 $\textrm{A}$ 행렬은 </p>
<p>
  $
  \mathbf{A} =
  \left( \begin{array}{ccc}
  -2 & 0   \\
  2 & -4  \\
  \end{array} \right)
  $
  </p>

<p> 고유근의 특성방정식이 $ \Pi(\lambda) = \lambda^2 - \textrm{tr(A)}\lambda + \textrm{det(A)} $ 일 때 </p>
<p> $ \textrm{tr(A)} = -6, \textrm{det(A)} = 8 $ 에서  </p>
<p> 근의 판정은 $ \textrm{tr(A)}^2 - 4\textrm{det(A)} = 36-32 > 0 $, 따라서 두 개의 실근이다. </p>
<p> $ \textrm{det(A)} = 8 > 0$ 이므로 근은 부호가 같고 $ \textrm{tr(A)} = -6 < 0 $ 이므로 두 근은 모두 음수이다. </p>
<p>따라서 해의 경로는 균형점 $(0, 8)$ 을 향해 수렴함을 알 수 있다.</p>

<div class="digitDiv">
    <svg width="800px" height="700px" viewBox="-100 100 1200 700" >
  <defs>
    <marker id="dark-arrow" viewBox="0 0 10 10" refX="1" refY="5"
        markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" />
    </marker>
    <marker id="blue-arrow" viewBox="0 0 10 10" refX="1" refY="5"
        markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" />
    </marker>
    <marker id="red-arrow" viewBox="0 0 10 10" refX="1" refY="5"
        markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" />
    </marker>
    <marker id="green-arrow" viewBox="0 0 10 10" refX="1" refY="5"
    markerWidth="6" markerHeight="6" orient="auto">
  <path d="M 0 0 L 10 5 L 0 10 z" />
  </marker>

  </defs>
  <polyline points="10,400 600,400" fill="none" stroke="black" 
      stroke-width="2" marker-end="url(#dark-arrow)" />
  <polyline points="300,600 300,100" fill="none" stroke="blue" 
      stroke-width="2" marker-end="url(#blue-arrow)" />
  <text id = "sgv-text" x="300" y="50"> y </text>
  <text id = "sgv-text" x="610" y="390" > x </text>
  <text id = "sgv-text" x="250" y="450" > 0 </text>
  
  <foreignObject x="320" y="100" width="100" height="100">
    <div  class="fig">
    $ x = 0 $
    </div>
  </foreignObject>
  <foreignObject x="100" y="700" width="500" height="100">
    <div  class="fig">
    (그림 4) $ \dfrac{dx}{dt} = 0 $ 의 위상도
    </div>
  </foreignObject>

  <polyline points="150,200 250,200" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="150,300 250,300" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="150,500 250,500" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="500,250 400,250" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="500,550 400,550" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="500,350 400,350" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
</svg>
</div>

<div class="digitDiv">
    <svg width="800px" height="700px" viewBox="-100 100 1200 700">
  
  <polyline points="290,400 800,400" fill="none" stroke="black" 
      stroke-width="2" marker-end="url(#dark-arrow)" />
  <polyline points="550,600 550,100" fill="none" stroke="black" 
      stroke-width="2" marker-end="url(#dark-arrow)" />
  <polyline points="300,450 700,200" fill="none" stroke="blue" 
      stroke-width="2" />
    <text id = "sgv-text" x="550" y="50"> y </text>
    <text id = "sgv-text" x="850" y="400" > x </text>
    <text id = "sgv-text" x="500" y="450" > 0 </text>
    <foreignObject x="700" y="210" width="200" height="100">
        <div  class="fig">
        $ y = \dfrac{1}{2}x + 8 $
        </div>
      </foreignObject>
    <foreignObject x="400" y="700" width="500" height="100">
        <div  class="fig">
        (그림 5) $ \dfrac{dy}{dt} = 0 $ 의 위상도
        </div>
      </foreignObject>

    <polyline points="300,350 300,420" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="400,300 400,370" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="600,150 600,240" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="350,550 350,450" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="430,500 430,400" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="630,380 630,280" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    
</svg>
</div>

<p> 그런데 미분방정식의 해를 구하지 않고도 위상도 분석만으로 해의 수렴, 발산 여부를 판정할 수 있다.</p>
<p>정상상태(steady state)에서 상태변수들은 시간에 따라 변하지 않으므로 $ \dfrac{dy}{dt} = 0, \dfrac{dx}{dt} = 0 $</p>

<p>(i) $\dfrac{dx}{dt} = -2x = 0 $</p>

<p> $ x = 0 $ 이므로 (그림 4)에서 y 축으로 표시. y 축을 중심으로 좌우에서 벡터의 방향을 추정.</p>

<p> $ \dfrac{dx}{dt} > 0  \Longrightarrow \dfrac{dx}{dt} = -2x > 0 \Longrightarrow x < 0 $</p>

<p>즉 x가 0보다 작은 구간(y 축의 좌측)에서는 x는 시간의 증가에 따라 증가한다. 이는 (그림 4)의 y축 좌측의 화살표 방향으로 표시된다. x가 증가하는 것이므로 화살표의 방향은 x가 0보다 작은 구간(그림의 2, 3사분면)에서 좌에서 우로 흐르는 모양이 된다.
<input type="checkbox" id="cb11" /><label for="cb11"><sup></sup>
</label>
<span><br><br>물론 시간의 감소의 경우는 화살표가 반대방향이 되겠지만 시간은 항상 증가하므로 시간의 감소는 고려하지 않는다. <br><br></span> </p>

<p> $ \dfrac{dx}{dt} < 0  \Longrightarrow x > 0 $</p>

<p>즉 x가 0보다 큰 구간(y 축의 우측)에서는 x는 시간의 증가에 따라 감소한다. 이는 (그림 4)의 y축 우측의 화살표 방향으로 표시된다. x가 감소하는 것이므로 화살표의 방향은 x가 0보다 큰 구간(그림의 1, 4사분면)에서 우에서 좌로 흐르는 모양이 된다.</p>


<p>(ii) $ \dfrac{dy}{dt} = 2x - 4y +32 $</p>

<p> $ \dfrac{dy}{dt} = 0 \Longrightarrow 2x - 4y +32 = 0 \Longrightarrow y = \dfrac{1}{2}x + 8  $ 이므로 (그림 5)의 파란선이다.</p>

<p> $ \dfrac{dy}{dt} > 0 \Longrightarrow 2x - 4y +32 > 0 $ 을 만족시키는 부분은 (그림 5)의 파란선을 기준으로 우하 부분이다.<input type="checkbox" id="cb7" /><label for="cb7"><sup></sup>
</label><span><br><br>일례로 (0, 0)을 대입해 보면 알 수 있음.<br><br></span> </p>
<p>따라서 우하에서는 시간이 지남에 따라 y는 증가하고 이는 (그림 5)에서 y축을 따라 아래서 위로 증가하는 방향으로 화살표가 그려진다. </p>

<p> $ \dfrac{dy}{dt} < 0 \Longrightarrow 2x - 4y +32 < 0 $ 을 만족시키는 부분은 (그림 5)의 파란선을 기준으로 좌상 부분이다<input type="checkbox" id="cb8" /><label for="cb8"><sup></sup>
</label><span><br><br>일례로 (0, 10)을 대입해 보면 알 수 있음.<br><br></span>. 따라서 좌상에서는 시간이 지남에 따라 y는 감소하고 이는 (그림 5)에서 y축을 따라 위에서 아래로 감소하는 방향으로 화살표가 그려진다.</p>

<svg width="800px" height="600px" viewBox="-200 100 1200 600" 
    >
  <polyline points="290,400 800,400" fill="none" stroke="black" 
      stroke-width="2" marker-end="url(#dark-arrow)" />
  <polyline points="550,600 550,100" fill="none" stroke="blue" 
      stroke-width="2" marker-end="url(#blue-arrow)" />
  <polyline points="300,450 750,200" fill="none" stroke="blue" 
      stroke-width="2" />
    <text id = "sgv-text" x="550" y="70"> y </text>
    <text id = "sgv-text" x="820" y="400" > x </text>
    <text id = "sgv-text" x="520" y="430" > 0 </text>
    <text id = "sgv-text" x="520" y="310" > 8 </text>
    <text id = "sgv-text" x="360" y="430" > -16 </text>
    <foreignObject x="760" y="190" width="200" height="100">
        <div  class="fig">
        $ y = \dfrac{1}{2}x + 8 $
        </div>
      </foreignObject>
    <foreignObject x="470" y="120" width="200" height="100">
        <div  class="fig">
        $ x = 0 $
        </div>
      </foreignObject>
    <foreignObject x="400" y="700" width="500" height="100">
        <div  class="fig">
        (그림 6) $ \dfrac{dy}{dt} = 0 $, $ \dfrac{dx}{dt} = 0 $ 의 위상도
        </div>
      </foreignObject>


    <polyline points="400,200 400,300" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="400,200 500,200" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="400,200 500,300" fill="none" stroke="green" 
      stroke-width="2" marker-end="url(#green-arrow)" />  
    <polyline points="700,80 700,180" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="700,80 600,80" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="700,80 600,180" fill="none" stroke="green" 
      stroke-width="2" marker-end="url(#green-arrow)" />
    <polyline points="400,550 400,450" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="400,550 500,550" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="400,550 500,450" fill="none" stroke="green" 
      stroke-width="2" marker-end="url(#green-arrow)" />
    <polyline points="700,450 700,350" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="700,450 600,450" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="700,450 600,350" fill="none" stroke="green" 
      stroke-width="2" marker-end="url(#green-arrow)" />
    <polyline points="551,150 551,250" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="551,450 551,350" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="700,250 600,250" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />
    <polyline points="420,350 520,350" fill="none" stroke="red" 
      stroke-width="2" marker-end="url(#red-arrow)" />

</svg>

<p>(i), (ii) 두 가지 경우를 모두 고려하여 화살표를 그리면 (그림 6)과 같다. 두 개의 빨간색 화살표의 합이 벡터의 방향을 나타내는 초록색 화살표이다. </p>

<p> $ x=0, y = \dfrac{1}{2}x + 8 $, 두 개의 선이 구간을 네 부분으로 구분한다.</p>
<p>각 구간에 따른 화살표의 방향은 앞의 결과를 합쳐서 그리면 된다. </p>
  <p>초록색 화살표는 빨간색 화살표들의 벡터합을 의미한다. 시간의 경과에 따라 초록색 화살표의 방향으로 상태변화가 이루어진다는 것을 의미한다. </p>
  <p> $ \dfrac{dx}{dt} = 0 $ 에서 $ x = 0$ 함수는 x의 변화율이 0을 의미하므로 이 선상에서는 상하로만 변화가 있음을 의미한다.</p>
  <p> $ \dfrac{dy}{dt} = 0 $ 에서 $ y = \dfrac{1}{2}x + 8 $ 함수는 y의 변화율이 0을 의미하므로 이 선상에서는 좌우로만 변화가 있음을 의미한다.</p>
  <p> 상태 $ x(t), y(t) $는 임의의 점에서 시작해도 (0, 8) 점을 향해 흐름을 알 수 있고, 이 점은 안정점이 된다.</p>

<div style="text-align : center;">
  
  <figure>
    <p>$$  
      \begin{tikzpicture}[scale=0.2]
          % draw the axis
          \draw [thick, ->] (-24,0) -- (24,0); 
          \draw [thick, ->] (0,-20) -- (0,24); 
  
          % 위상 화살표 그리기
          \draw [red,->] (-16,16) -- (-8,16); 
          \draw [red,->] (-16,16) -- (-16,8); 
          \draw [red,->] (-16,16) -- (-8,8); 
  
          \draw [red,->] (10,22) -- (2,22); 
          \draw [red,->] (10,22) -- (10,14); 
          \draw [red,->] (10,22) -- (2,14); 
  
          \draw [red,->] (-12,-10) -- (-12,-2); 
          \draw [red,->] (-12,-10) -- (-4,-10); 
          \draw [red,->] (-12,-10) -- (-4,-2); 
  
          \draw [red,->] (10,-2) -- (10,6); 
          \draw [red,->] (10,-2) -- (2,-2); 
          \draw [red,->] (10,-2) -- (2,6); 
  
          \draw [green,ultra thick,->] (-22,8) .. controls (-16,2) and (-10,2) .. (-4,4); 
          \draw [green,ultra thick,->] (-4,-20) .. controls (-8,-10) and (-8,-2) .. (-4,2);
          \draw [green,ultra thick,->] (4,24) .. controls (6,20) and (6,16) .. (2,12);
          \draw [green,ultra thick,->] (22,6) .. controls (16,16) and (12,16) .. (2,10);
          
          % 기준선 그리기
          % \draw [blue, thick, domain=-1:2.5] plot (\x, \x-0.5);
          \draw [blue, ultra thick, ->] (0,-20) -- (0,24); 
          \draw [blue, ultra thick, domain=-22:22] plot (\x, 0.5*\x+8);
  
          % draw the labels
          \node at (-2,-2) {$0$};
          \node at (-2,8) {$8$};
          \node at (-16,-2) {$-16$};
          \node at (22,14){$y=\dfrac{1}{2}x+8$};
          \node at (-4,22){$x=0$};
          \node at (26,0){$x$};
          \node at (0,26){$y$};
          
      \end{tikzpicture}
      $$</p>
       <br>     
            <figcaption>
              (그림 7) 위상도
            </figcaption>
    </figure> 
    </div>
    <br> 

    <p>기준선에서 화살표의 방향이 바뀌는 점에 유의하면서 해의 경로를 그리면 (그림 7)의 굵은 초록색 화살표의 모양이 된다. 초록색 화살표는 여러 가지 초기값에 대응하는 해의 경로를 표시한 것이다. </p>
  
<p> 임의의 점에서 시작하는 벡터들의 모음인 상변화도()phase portraiy를 그려보면 (그림 8)과 같다. 상변화도란 각각의 점에서 변화를 의미하는 벡터필드(vector field)들의 모음이다.</p>

<div style="text-align : center;">
  <img src="phase-diagram2.bmp"><br>
  (그림 8)  상변화도
  </div>

  <div class="compute"><script type="text/x-sage">
import matplotlib.pyplot as plt
import numpy as np
import matplotlib.lines as mlines
import matplotlib.patches as mpatches
from scipy.integrate import odeint

def add_arrow_to_line2D(
    axes, line, arrow_locs=[0.2, 0.4, 0.6, 0.8],
    arrowstyle='-|>', arrowsize=1, transform=None):
    
    if not isinstance(line, mlines.Line2D):
        raise ValueError("expected a matplotlib.lines.Line2D object")
    x, y = line.get_xdata(), line.get_ydata()

    arrow_kw = {
        "arrowstyle": arrowstyle,
        "mutation_scale": 10 * arrowsize,
    }

    color = line.get_color()
    use_multicolor_lines = isinstance(color, np.ndarray)
    if use_multicolor_lines:
        raise NotImplementedError("multicolor lines not supported")
    else:
        arrow_kw['color'] = color

    linewidth = line.get_linewidth()
    if isinstance(linewidth, np.ndarray):
        raise NotImplementedError("multiwidth lines not supported")
    else:
        arrow_kw['linewidth'] = linewidth

    if transform is None:
        transform = axes.transData

    arrows = []
    for loc in arrow_locs:
        s = np.cumsum(np.sqrt(np.diff(x) ** 2 + np.diff(y) ** 2))
        n = np.searchsorted(s, s[-1] * loc)
        arrow_tail = (x[n], y[n])
        arrow_head = (np.mean(x[n:n + 2]), np.mean(y[n:n + 2]))
        p = mpatches.FancyArrowPatch(
            arrow_tail, arrow_head, transform=transform,
            **arrow_kw)
        axes.add_patch(p)
        arrows.append(p)
    return arrows


# Define a function for the system of ODEs
def f(y, t):
    y1, y2 = y # unpack variables
    dydt = [-2*y1, 2*y1-4*y2+32] # define derivatives
    return dydt

# Define a grid of points for plotting
x = np.linspace(-16, 16, 21)
y = np.linspace(-16, 16, 21)
X, Y = np.meshgrid(x, y)

# Evaluate the system on the grid
t = np.linspace(0, 10, 101)
u, v = np.zeros(X.shape), np.zeros(Y.shape)
NI, NJ = X.shape
for i in range(NI):
    for j in range(NJ):
        xdot = f([X[i,j], Y[i,j]],t)
        u[i,j] = xdot[0]
        v[i,j] = xdot[1]

# Plot the vector field using quiver
fig, ax = plt.subplots(1, 1)
ax.quiver(X,Y,u,v,color='r')

u1 = np.linspace(-15, 15, 4)
v1 = np.linspace(-15, 15, 4)

initial_conditions = []
for i in range(len(u1)):
    for j in range(len(v1)):
        initial_conditions.append([u1[i], v1[j]])

lines = []
for y in initial_conditions:
    sol = odeint(f,y,t)
    line, = ax.plot(sol[:,0], sol[:,1], 'b')
    lines.append(line)

for line in lines:
    add_arrow_to_line2D(ax, line,
                        arrow_locs=[0.2, 0.4, 0.6,
                                    0.8, 1.0],
                        arrowstyle='->')

# Show the plot
plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.grid(True)
plt.show()
          </script></div>  

<h3> 예2: local stock polution model </h3>

<p> $ \dfrac{dx}{dt} = 0.5x + 0.5y - 15 $</p>
<p> $ \dfrac{dy}{dt} = x - 0.5y $</p>
<br>
<p> $ y(t) $ : 대기오염의 규모</p>
<p> $ x(t) $ : 배출가스의 양</p>

<p id="min1">[풀이]</p>
<p>정상상태(steady state)에서 상태변수들은 시간에 따라 변하지 않으므로</p>
<p> $ \dfrac{dy}{dt} = 0 $, $ \dfrac{dx}{dt} = 0 $ 인 선들을 그리면 (그림 6a), (그림 6b)와 같다.</p>
<p> $ \dfrac{dy}{dt} = x - 0.5y \Longrightarrow  y = 2x $ .................... ①</p>
<p> $ \dfrac{dx}{dt} = 0.5x + 0.5y - 15 \Longrightarrow y = -x + 30 $ ................② </p>

<p>균형점은 $ \dfrac{dx}{dt} = \dfrac{dy}{dt} = 0 $ 에서 결정되므로 </p>
<p> 이 두 연립방정식의 해는 ①, ②를 동시에 만족시켜야 한다.</p>
<p>따라서 균형점은 $(10, 20)$ 이 된다.</p>

<p> 이 연립미분방정식의 $\textrm{A}$ 행렬은 </p>
<p>
  $
  \mathbf{A} =
  \left( \begin{array}{ccc}
  \dfrac{1}{2} & \dfrac{1}{2}   \\
  1 & -\dfrac{1}{2}  \\
  \end{array} \right)
  $
  </p>

<p> $ \textrm{tr(A)} = 0, \textrm{det(A)} = -\dfrac{3}{4} $ 에서  </p>
<p> 근의 판정은 $ \textrm{tr(A)}^2 - 4\textrm{det(A)} = 3 > 0 $, 따라서 두 개의 실근이다. </p>
<p> $ \textrm{det(A)} = -\dfrac{3}{4} < 0 $ 이므로 근은 부호가 다르고 $ \textrm{tr(A)} = 0 $ 이므로 두 근은 절대값이 같다. </p>
<p>따라서 해의 경로는 균형점 $(10, 20)$ 에서 한쪽은 수렴, 한 쪽은 발산하는데 이런 점을 안장점이라고 한다. </p>
<p>이제 좀 더 자세한 해의 경로를 그리면 다음과 같다.</p>

<div class="digitDiv">
  <svg width="800px" height="700px" viewBox="-100 100 1200 700" 
  >

<polyline points="10,500 600,500" fill="none" stroke="black" 
    stroke-width="2" marker-end="url(#dark-arrow)" />
<polyline points="100,600 100,100" fill="none" stroke="black" 
    stroke-width="2" marker-end="url(#dark-arrow)" />
<polyline points="40,600 350,100" fill="none" stroke="blue" 
    stroke-width="2" />
<text id = "sgv-text" x="100" y="50"> y </text>
<text id = "sgv-text" x="630" y="500" > x </text>
<text id = "sgv-text" x="40" y="550" > 0 </text>

<foreignObject x="350" y="100" width="100" height="100">
  <div  class="fig">
  $ y = 2x $
  </div>
</foreignObject>
<foreignObject x="100" y="700" width="500" height="100">
  <div  class="fig">
  (그림 9) $ \dfrac{dy}{dt} = 0 $ 의 위상도
  </div>
</foreignObject>

<polyline points="150,300 150,400" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="300,50 300,150" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="150,550 150,450" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
  <polyline points="300,300 300,200" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
</svg>
</div>

<div class="digitDiv">
  <svg width="800px" height="700px" viewBox="-100 100 1200 700" 
  >

<polyline points="290,500 800,500" fill="none" stroke="black" 
    stroke-width="2" marker-end="url(#dark-arrow)" />
<polyline points="350,600 350,100" fill="none" stroke="black" 
    stroke-width="2" marker-end="url(#dark-arrow)" />
<polyline points="290,150 800,600" fill="none" stroke="blue" 
    stroke-width="2" />
  <text id = "sgv-text" x="350" y="50"> y </text>
  <text id = "sgv-text" x="820" y="500" > x </text>
  <text id = "sgv-text" x="320" y="540" > 0 </text>
  <foreignObject x="800" y="600" width="200" height="100">
      <div  class="fig">
      $ y = -x + 30 $
      </div>
    </foreignObject>
  <foreignObject x="400" y="700" width="500" height="100">
      <div  class="fig">
      (그림 10) $ \dfrac{dx}{dt} = 0 $ 의 위상도
      </div>
    </foreignObject>


  <polyline points="400,200 500,200" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
<polyline points="500,300 600,300" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
<polyline points="550,450 450,450" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
<polyline points="500,350 400,350" fill="none" stroke="red" 
    stroke-width="2" marker-end="url(#red-arrow)" />
  
</svg>
</div>

<p> (그림 9)에서 </p>
<p> $ y = 2x $의 좌상쪽에 있는 점들은 $ y > 2x $ <input type="checkbox" id="cb13" /><label for="cb13"><sup></sup>
</label><span><br><br> 예를 들어 (0, 1) 은 y = 2x의 좌상쪽에 있는 점이다. x = 0, y = 1을 y = 2x에 대입하면 1 > 0. 따라서 y > 2x <br><br></span>,   $ y > 2x $이므로 ①에서 $ \dfrac{dy}{dt} < 0 $
 시간이 지남에 따라 y는 감소한다. </p>
 <p> $ y = 2x $의 우하쪽에 있는 점들은 $ y < 2x $ <input type="checkbox" id="cb15" /><label for="cb15"><sup></sup>
 </label><span><br><br>예를 들어 (1, 0) 은 y = 2x의 우하쪽에 있는 점이다. x = 1, y = 0을 y = 2x에 대입하면 0 > 2. 따라서 y < 2x <br><br></span>, $ y < 2x $이므로 ①에서 $ \dfrac{dy}{dt} > 0 $
 시간이 지남에 따라 y는 증가한다.</p>
 <p> $ \dfrac{dy}{dt} = 0 \Longrightarrow  y = 2x $ 이므로 $ y = 2x $ 선상에서는 y 변화는 없고 x 변화만 있으므로 수평으로 변동</p>
 <p>화살표는 항상 시간이 지남에 따라 상태변수의 증감을 의미. 시간의 감소는 고려하지 않는다. </p>

 <p> (그림 10)에서  </p>
 <p> $ y = -x + 30 $의 우상쪽에 있는 점들은 $ y > -x + 30 $<input type="checkbox" id="cb6" /><label for="cb6"><sup></sup>
 </label><span><br><br>예를 들어 (30, 30) 은 y = -x + 30의 우상쪽에 있는 점이다. x = 30, y = 30을 y = -x + 30에 대입하면 30 > 0, 따라서 y > -x + 30<br><br></span>, </p>
  <p> $ y > -x + 30 $ 이므로 ② 에서 $ \dfrac{dy}{dt} > 0 $, 즉 시간이 지남에 따라 x는 증가한다.</p>
 
 <p> $ y = -x + 30 $ 의 좌하쪽에 있는 점들은 y < -x + 30<input type="checkbox" id="cb17" /><label for="cb17"><sup></sup>
 </label><span><br><br>예를 들어 (0, 0) 은 y = -x + 30의 좌하쪽에 있는 점이다. x = 0, y = 0을 y = -x + 30에 대입하면 0 < 30, 따라서 y < -x + 30<br><br></span>, </p>

  <p> $ y < -x + 30 $ 이므로 ②에서 $ \dfrac{dy}{dt} < 0 $, 즉 시간이 지남에 따라 x는 감소한다.</p>
  <p> $ \dfrac{dx}{dt} = 0 \Longrightarrow y = -x + 30 $ 이므로 $y = -x + 30 $ 선상에서는 x 변화는 없고 y 변화만 있으므로 수직으로 변동 </p>
  
  <p> 두 그림을 결합하여 그리면 다음과 같다. 두 개의 직선이 이루는 부분을 4 구역으로 구분한 다음 앞에서 구한 화살표의 방향을 합치면 (그림 7) 과 같다.
 </p>

 <div style="text-align : center;">
  <img src="phase-diagram3.bmp"><br>
  (그림 11)  $ \dfrac{dy}{dt} = x - 0.5y $ , $ \dfrac{dx}{dt} = 0.5x + 0.5y - 15 $ 위상도
  </div>
<br>
  <p>(그림 11)에서 녹색 화살표는 각 수직, 수평 화살표의 합인 벡터의 방향을 의미하며 (그림 11)에는 표시되지 않았지만 각 구간마다 수많은 녹색 벡터들이 존재한다. 고동색 화살표는 이러한 고동색 벡터들의 흐름을 나타낸다. </p>
    <p>두 직선이 교차하는 점 (10, 20)이 정상상태(steady state)이다. 그러나 이 점은 안정적이지 않다.</p>
    <p>  (그림 7)의 상하 분면에서는 (10, 20)으로 접근하지만 좌우 분면에서는 (10, 20)으로 발산함을 알 수 있다. 즉 임의의 점에서 (10, 20)로 접근하려 하면 화살표의 방향에 따라 외부로 발산함을 알 수 있다. 따라서 (10, 20)은 안정상태(stable state)가 아님을 알 수 있다.  이러한 점을 안장점(鞍裝點, saddle point)이라 하고 안장점으로 이루어진 경로를 안장경로(saddle path)라 부른다. </p>

    <p> 임의의 점에서 시작하는 벡터들의 모음인 상변화도를 그려보면 (그림 12)와 같다. </p>

    <div style="text-align : center;">
      <img src="phase-diagram4.bmp"><br>
      (그림 12)  $ \dfrac{dy}{dt} = x - 0.5y $ , $ \dfrac{dx}{dt} = 0.5x + 0.5y - 15 $ 상변화도
      </div>
<br>

<h2>위상도 분석의 강점과 제약</h2>
<p>
 위상도는 시간축이 없으므로 균형에 이르기까지 얼마나 시간이 걸리는지를 알 수 없다.
 위상도는 변수들의 동시 움직임을 나타내므로, 토빈의 q 이론에서 보듯이 자본량(capital stock)이 높을 때 자본의 가격은 낮다. 또는 그 역도 성립.(사소한 것이지만 기본 성장모형에서는 나타나지 않음)
 조정 속도는 균형경로의 모양에 따라 다를 수 있다. 가파른 경로는 빠른 수렴을, 완만한 곡선은 느린 조정속도를 의미한다.
</p>

</body>
</html>